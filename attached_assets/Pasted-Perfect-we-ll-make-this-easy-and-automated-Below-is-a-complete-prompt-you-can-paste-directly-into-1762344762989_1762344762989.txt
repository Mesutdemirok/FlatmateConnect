Perfect ‚Äî we‚Äôll make this easy and automated.
Below is a complete prompt you can paste directly into your Replit Agent‚Äôs chat window.
It tells the Agent to:

‚úÖ Create and connect the /api/proxy route (for iOS image loading)
‚úÖ Verify the listings show images correctly
‚úÖ Then finish the rest of the mobile app MVP setup (Profile, Messages, Tabs)
‚úÖ Test all endpoints automatically
‚úÖ Push everything to production domain (https://www.odanet.com.tr/api)

‚∏ª

üß† Full Replit Agent Prompt

Copy‚Äìpaste this into your Replit Agent exactly as-is üëá

‚∏ª


üß© TASK: Finalize and optimize Odanet full-stack integration

I need you to complete the following backend + mobile tasks step by step:

---

## 1Ô∏è‚É£ BACKEND ‚Äì IMAGE PROXY FIX
Goal: Make iOS devices display CDN-hosted images.

- Create a new route file: `server/routes/proxy.ts`
- Add a secure image proxy that fetches any CDN image (from https://cdn.odanet.com.tr) and streams it securely from our main domain (`https://www.odanet.com.tr/api/proxy/...`).
- Include this code (use node-fetch):

```ts
import express from "express";
import fetch from "node-fetch";

const router = express.Router();

router.get("/proxy/*", async (req, res) => {
  try {
    const targetPath = req.params[0];
    if (!targetPath) return res.status(400).json({ error: "No image path provided" });

    const cdnUrl = `https://cdn.odanet.com.tr/${targetPath}`;
    console.log("üîÅ Proxying image:", cdnUrl);

    const response = await fetch(cdnUrl);
    if (!response.ok) {
      console.error("‚ùå CDN fetch failed:", response.status);
      return res.status(response.status).json({ error: "Failed to load image" });
    }

    res.set("Content-Type", response.headers.get("content-type") || "image/jpeg");
    response.body.pipe(res);
  } catch (err) {
    console.error("‚ùå Proxy error:", err);
    res.status(500).json({ error: "Proxy server error", details: err.message });
  }
});

export default router;

Then import and register it in server/index.ts:

import proxyRouter from "./routes/proxy";
app.use("/api", proxyRouter);

‚úÖ Test it manually:

curl https://www.odanet.com.tr/api/proxy/listings/1762204009085-em2hy1.jpg

‚Üí Should return the same image as the CDN.

‚∏ª

2Ô∏è‚É£ MOBILE APP ‚Äì VERIFY IMAGE LOADING
	‚Ä¢	Ensure Expo app (odanet-mobile/app/(tabs)/index.tsx) uses this fallback:

const fallbackUri = uri.replace(
  "https://cdn.odanet.com.tr",
  "https://www.odanet.com.tr/api/proxy"
);

	‚Ä¢	Reload Expo (npx expo start -c)
	‚Ä¢	Verify that iOS now shows listing images.

‚∏ª

3Ô∏è‚É£ BACKEND ‚Äì ENABLE BASIC PROFILE & MESSAGING
	‚Ä¢	Make sure /api/auth/me returns current user with safe fields.
	‚Ä¢	Make sure /api/messages/:userId and /api/messages endpoints work with authentication token.
	‚Ä¢	Add sample test logs for these endpoints.

‚∏ª

4Ô∏è‚É£ MOBILE APP ‚Äì CONNECT PROFILE & MESSAGES SCREENS
	‚Ä¢	For app/(tabs)/profile.tsx ‚Üí show current user info from /api/auth/me.
	‚Ä¢	For app/(tabs)/messages.tsx ‚Üí show conversation list from /api/conversations.
	‚Ä¢	Use SecureStore to load the saved JWT token from login and attach it in axios headers.

Add simple placeholders if real data unavailable.

‚∏ª

5Ô∏è‚É£ FINAL CHECKS & DEPLOYMENT
	‚Ä¢	Verify /api/health ‚Üí ‚úÖ returns JSON
	‚Ä¢	Verify /api/listings ‚Üí returns JSON with image paths
	‚Ä¢	Verify /api/proxy/... ‚Üí streams actual image
	‚Ä¢	Ensure all routes are working on https://www.odanet.com.tr/api/...
	‚Ä¢	Run Expo app on iOS/Android and confirm images, profile, messages, listings all render.

‚∏ª

üéØ Success Criteria

‚úÖ Listings show images (via proxy fallback)
‚úÖ Profile + Messages tabs connected
‚úÖ All API endpoints return valid JSON
‚úÖ Deployed to production domain (https://www.odanet.com.tr/api)
‚úÖ No hook or CORS errors
‚úÖ Mobile app starts via Expo Go without issues

‚∏ª

If anything fails (especially images), show logs and fix automatically.
When done, summarize with:
	‚Ä¢	Changes made
	‚Ä¢	Tests run
	‚Ä¢	Verification results
	‚Ä¢	Next improvement suggestions

---

### üß© Optional Add-on

After it finishes, you can ask:
> ‚ÄúNow add caching headers (ETag + 7d max-age) to the proxy route for faster image load.‚Äù

That will make the app load images much faster next time.

---

Would you like me to include a **follow-up Agent prompt** for improving the UI (cards with shadows, image aspect ratio, profile picture, etc.) once the proxy and connections work?