
â¸»

ğŸ§  Agent Prompt â€” Enforce Mandatory Image Upload for All Listings (Seekers + Rooms)

Goal:
Ensure that both room seeker profiles and room listings must include at least one valid image before they can be published.
This must apply across backend, web, and mobile (Expo).

â¸»

ğŸ¯ Objectives

ğŸ§© 1. Backend Validation (Express + Drizzle)
Update the backend routes in server.js (inside registerRoutes) for both:
	â€¢	/api/seekers
	â€¢	/api/listings

Add validation logic before creating or updating:

For Seeker Profiles

if (!data.profilePhotoUrl || data.profilePhotoUrl.trim() === "") {
  return res.status(400).json({
    message: "Profil fotoÄŸrafÄ± eklenmeden ilan yayÄ±nlanamaz.",
  });
}

For Room Listings

if (!data.images || data.images.length === 0) {
  return res.status(400).json({
    message: "En az bir oda fotoÄŸrafÄ± eklenmeden ilan yayÄ±nlanamaz.",
  });
}

	â€¢	These rules apply when:
	â€¢	Creating (POST /api/seekers, POST /api/listings)
	â€¢	Updating (PUT /api/seekers/:id, PUT /api/listings/:id)
	â€¢	Setting isPublished: true in any payload

ğŸ§± Important: Keep the logic before storage.createListing() and storage.createSeekerProfile() calls to block invalid inserts.

â¸»

ğŸ“± 2. Mobile App Validation (Expo)
In /odanet-mobile/app/ilan-olustur.tsx and /odanet-mobile/app/oda-arama-ilani-olustur.tsx:
	â€¢	Add front-end validation before publishing:
	â€¢	If no image is uploaded, show alert:
â€œLÃ¼tfen en az bir fotoÄŸraf yÃ¼kleyin. FotoÄŸrafsÄ±z ilan yayÄ±nlanamaz.â€
	â€¢	Disable â€œYayÄ±nlaâ€ button until image upload is complete.
	â€¢	Highlight missing image section in red.
	â€¢	Update image upload components to check that profilePhotoUrl or images[] array is not empty before submitting.

â¸»

ğŸ’» 3. Web App Validation (Next.js)
In:
	â€¢	/frontend/src/app/ilan-olustur/page.tsx
	â€¢	/frontend/src/app/oda-arama-ilani-olustur/page.tsx

Add a front-end guard before submission:

if (!image || !image.length) {
  alert("LÃ¼tfen en az bir fotoÄŸraf yÃ¼kleyin. FotoÄŸrafsÄ±z ilan yayÄ±nlanamaz.");
  return;
}

	â€¢	Prevent API request if the check fails.
	â€¢	Smooth scroll to the upload field when validation fails.
	â€¢	Display a red warning message under the photo uploader.

â¸»

ğŸ§  4. Feed & Fallback Logic
	â€¢	Update listing and seeker card components (ListingCard.tsx, SeekerCard.tsx, or UnifiedCard.tsx) to only render published items with valid images.
	â€¢	If backend validation already enforced, fallback images should be used only for legacy data created before this rule.

â¸»

ğŸ”„ 5. Testing & Sync
After implementing:
	â€¢	Test creating a new seeker or room listing without image â†’ should show validation error (not published).
	â€¢	Test creating one with image â†’ should publish successfully.
	â€¢	Ensure both mobile and web frontends handle the same logic visually and via backend.

â¸»

âœ… Deliverables
	1.	Backend rules enforced for all publishes (seekers + listings).
	2.	Web & mobile frontends block publish until image is uploaded.
	3.	Unified consistent user message across all platforms.
	4.	Fallback images remain only for old legacy data.
	5.	Confirmation message:
â€œâœ… Image requirement enforced â€” seekers and listings cannot be published without a photo across web + mobile.â€

