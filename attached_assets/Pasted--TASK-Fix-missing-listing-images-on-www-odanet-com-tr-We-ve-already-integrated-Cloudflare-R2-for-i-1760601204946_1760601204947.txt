
TASK: Fix missing listing images on www.odanet.com.tr

We’ve already integrated Cloudflare R2 for image storage.
Here’s what’s currently in place:
	1.	Environment:
	•	Deployed on Replit Autoscale with domain www.odanet.com.tr
	•	Static assets served via Express.
	•	R2 bucket name: odanet-uploads
	•	R2 public URL: (from secrets) https://pub-f084c4d11d4541f2a83f290d3f7f761e.r2.dev
	•	Secrets already set: R2_ACCESS_KEY_ID, R2_SECRET_ACCESS_KEY, R2_BUCKET_NAME, R2_PUBLIC_URL, R2_S3_ENDPOINT
	2.	Code:
	•	In server/storage.ts, we use the AWS SDK (@aws-sdk/client-s3) to connect to Cloudflare R2.
	•	All getListingImages() now returns absolute URLs via a helper:

function getImageUrl(relativePath) {
  const publicUrl = process.env.R2_PUBLIC_URL;
  if (process.env.NODE_ENV === "production" && publicUrl)
    return `${publicUrl}/${relativePath.replace(/^\/+/, "")}`;
  else
    return `/uploads/${relativePath.replace(/^\/+/, "")}`;
}


	•	Local preview works fine (.replit.dev), but in production, images show broken boxes.
	•	Health check /uploads/health.txt returns OK.

	3.	Goal:
Make images display correctly on www.odanet.com.tr in both listing cards and seeker cards.
If needed, update:
	•	Express static middleware order (ensure /uploads route is defined before SSR).
	•	MIME type or Content-Type headers for JPEG/PNG/WEBP.
	•	Cloudflare R2 bucket permissions or public URL path.
	•	Verify that production build points to process.env.R2_PUBLIC_URL instead of relative /uploads.
	4.	Expected:
	•	✅ All image tags on listings use full Cloudflare R2 URLs.
	•	✅ Images render without download or CORS errors.
	•	✅ Health check and /uploads routes stay valid.
	•	✅ www.odanet.com.tr/oda-ilanlari loads visible images.

Please run diagnostics, verify routes and static serving order, confirm the R2 URL is publicly accessible, and automatically apply the minimal safe fix to make images visible on production.
Do not modify frontend layout or components — only fix the backend serving logic and static mapping if needed.
After applying, republish automatically and verify /uploads/listings/test.jpg loads correctly in production.
