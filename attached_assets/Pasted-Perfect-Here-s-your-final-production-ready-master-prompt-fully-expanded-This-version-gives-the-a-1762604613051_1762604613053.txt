Perfect. Here‚Äôs your final, production-ready master prompt, fully expanded.
This version gives the agent end-to-end control ‚Äî it not only fixes the problems, but also validates them automatically after deployment.

‚∏ª

üß† MASTER PROMPT: ‚ÄúFull Redirect, SEO, Sitemap & Auto-Validation for Odanet.com.tr‚Äù

Goal: Make Odanet.com.tr fully indexable, SEO-optimized, and verified in Google Search Console.
The system must automatically fix, rebuild, and confirm all changes with live validation.

‚∏ª

üîç Context Summary
	‚Ä¢	Platform: Next.js app hosted on Replit
	‚Ä¢	Database: Neon PostgreSQL (verified connected, 24 listings)
	‚Ä¢	Issue Summary:
	‚Ä¢	Only 9 pages indexed / 36 not indexed
	‚Ä¢	Legacy URLs (UUID-only) now return 200 or 404 instead of redirect
	‚Ä¢	Canonical mismatches, ‚Äúcrawled ‚Äì currently not indexed‚Äù warnings
	‚Ä¢	Sitemap outdated; internal linking minimal
	‚Ä¢	HTTPS, Breadcrumbs, and Core Web Vitals ‚úÖ fine

‚∏ª

üß± Tasks to Perform

1Ô∏è‚É£ Redirect Fix (critical)
Ensure redirects are live via next.config.js at project root:

/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  async redirects() {
    return [
      {
        source: '/oda-ilani/:id([0-9a-fA-F\\-]{36})',
        destination: '/oda-ilani/:slug-:id',
        permanent: true,
      },
      {
        source: '/oda-arayan/:id([0-9a-fA-F\\-]{36})',
        destination: '/oda-arayan/:slug-:id',
        permanent: true,
      },
    ];
  },
};

module.exports = nextConfig;

Then rebuild cleanly:

rm -rf .next && npm run build

‚úÖ Expected:
curl -I https://odanet.com.tr/oda-ilani/5a2eba2f-97ac-472c-8097-bd6dc13daf03
‚Üí returns HTTP/2 301 and correct slug URL.

‚∏ª

2Ô∏è‚É£ Sitemap & Robots
/public/sitemap.xml.js

import { db } from "@/server/db";

export async function GET() {
  const listings = await db.query.listings.findMany();
  const seekers = await db.query.seeker_profiles.findMany();
  const baseUrl = "https://odanet.com.tr";

  const urls = [
    ...listings.map(l => `${baseUrl}/oda-ilani/${l.slug}-${l.id}`),
    ...seekers.map(s => `${baseUrl}/oda-arayan/${s.slug}-${s.id}`),
    `${baseUrl}/`,
    `${baseUrl}/oda-ilani-ver`,
    `${baseUrl}/oda-arayan-ver`,
    `${baseUrl}/blog`
  ];

  const xml = `<?xml version="1.0" encoding="UTF-8"?>
  <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    ${urls.map(u => `<url><loc>${u}</loc></url>`).join("")}
  </urlset>`;

  return new Response(xml, { headers: { "Content-Type": "application/xml" } });
}

/public/robots.txt

User-agent: *
Allow: /
Sitemap: https://odanet.com.tr/sitemap.xml


‚∏ª

3Ô∏è‚É£ Internal Linking
Add persistent links to:
	‚Ä¢	/oda-ilanlari
	‚Ä¢	/oda-arayanlar
	‚Ä¢	/oda-ilani-ver
	‚Ä¢	/oda-arayan-ver
	‚Ä¢	/blog

Ensure listings link back to their city or category pages.
‚Üí Goal: better crawl depth and link equity distribution.

‚∏ª

4Ô∏è‚É£ SEO Hygiene
In _app.tsx or layout.tsx:

<Head>
  <title>{title ? `${title} | Odanet` : "Odanet ‚Äì Oda Payla≈ü ve Ev Arkada≈üƒ± Bul"}</title>
  <link rel="canonical" href={`https://odanet.com.tr${router.asPath}`} />
  <meta name="description" content={description || "T√ºrkiye‚Äôde oda kiralamak veya ev arkada≈üƒ± bulmak i√ßin g√ºvenli platform."} />
  <meta property="og:title" content={title} />
  <meta property="og:url" content={`https://odanet.com.tr${router.asPath}`} />
  <meta property="og:image" content={imageUrl || "https://odanet.com.tr/og-image.png"} />
  <meta name="twitter:card" content="summary_large_image" />
</Head>


‚∏ª

5Ô∏è‚É£ Google Auto-Reindex Ping
Create /scripts/pingGoogle.js:

import fetch from "node-fetch";

async function pingGoogle() {
  const sitemapUrl = "https://odanet.com.tr/sitemap.xml";
  const res = await fetch(`https://www.google.com/ping?sitemap=${sitemapUrl}`);
  console.log("‚úÖ Google reindex ping sent:", res.status);
}

pingGoogle();

Run after each deploy:

node scripts/pingGoogle.js


‚∏ª

6Ô∏è‚É£ Cache Invalidation
If CDN or Replit edge cache is used, purge cache after build:

await fetch("https://api.cloudflare.com/client/v4/zones/YOUR_ZONE_ID/purge_cache", {
  method: "POST",
  headers: {
    "Authorization": "Bearer YOUR_API_TOKEN",
    "Content-Type": "application/json"
  },
  body: JSON.stringify({ purge_everything: true })
});

If Cloudflare not used:

rm -rf .next && npm run build


‚∏ª

üîé 7Ô∏è‚É£ Automated Validation (Post-Deploy)

After deployment, automatically validate all critical endpoints:

# Redirect check
curl -I https://odanet.com.tr/oda-ilani/5a2eba2f-97ac-472c-8097-bd6dc13daf03

# Sitemap reachable
curl -I https://odanet.com.tr/sitemap.xml

# Robots accessible
curl -I https://odanet.com.tr/robots.txt

# Canonical header validation (ensure correct domain)
curl -s https://odanet.com.tr | grep canonical

‚úÖ Expected:
	‚Ä¢	HTTP/2 301 for redirects
	‚Ä¢	HTTP/2 200 for sitemap & robots
	‚Ä¢	Canonical tag: <link rel="canonical" href="https://odanet.com.tr/...">

Once these validations pass, trigger:

node scripts/pingGoogle.js


‚∏ª

üßæ Deliverables
	1.	Redirects work (verified 301).
	2.	Sitemap & robots regenerated correctly.
	3.	Canonical + OG meta added.
	4.	Internal linking strengthened.
	5.	Cache invalidated after deployment.
	6.	Google reindex ping executed automatically.
	7.	All validations pass with expected HTTP codes.

‚∏ª

‚úÖ Final Goal

Google Search Console starts showing:
	‚Ä¢	Increasing indexed pages
	‚Ä¢	No ‚ÄúCrawled ‚Äì not indexed‚Äù or ‚Äú404‚Äù issues
	‚Ä¢	Correct redirects from old UUID URLs
	‚Ä¢	Sitemap and canonical consistency

‚∏ª

Would you like me to include a short ‚Äúpost-deployment monitoring script‚Äù in this same prompt (that automatically checks every 6 hours and alerts if the sitemap or redirects break)?
It‚Äôs a lightweight 15-line cron job that can be integrated in Replit.